const body0 = '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 208.8 181.82">\n    <ellipse class="cls-1" cx="38.32" cy="32.92" rx="38.32" ry="32.92" fill="currentColor"/>\n    <ellipse class="cls-1" cx="102.48" cy="32.92" rx="38.32" ry="32.92" fill="currentColor"/>\n    <ellipse class="cls-1" cx="170.48" cy="32.92" rx="38.32" ry="32.92" fill="currentColor"/>\n    <path class="cls-1" d="M208.8,38.67c0,79.06-46.74,143.14-104.4,143.14S0,117.73,0,38.67h208.8Z" fill="currentColor"/>\n</svg>\n';
const body1 = '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 284.65 181.82">\n      <circle class="cls-1" cx="96.58" cy="27.89" r="27.89" fill="currentColor" />\n      <circle class="cls-1" cx="55.79" cy="38.19" r="27.89" fill="currentColor" />\n      <circle class="cls-1" cx="27.89" cy="66.09" r="27.89" fill="currentColor" />\n      <circle class="cls-1" cx="256.75" cy="66.09" r="27.89" fill="currentColor" />\n      <circle class="cls-1" cx="238.21" cy="104.28" r="27.89" fill="currentColor" />\n      <circle class="cls-1" cx="40.8" cy="104.28" r="27.89" fill="currentColor" />\n      <circle class="cls-1" cx="75.82" cy="123.95" r="27.89" fill="currentColor" />\n      <circle class="cls-1" cx="210.32" cy="123.95" r="27.89" fill="currentColor" />\n      <circle class="cls-1" cx="228.86" cy="38.19" r="27.89" fill="currentColor" />\n      <circle class="cls-1" cx="188.25" cy="27.89" r="27.89" fill="currentColor" />\n      <ellipse class="cls-1" cx="142.32" cy="90.91" rx="58.64" ry="90.91" fill="currentColor" />\n</svg>\n';
const body2 = '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 336.97 181.82">\n      <rect class="cls-1" x="24.03" y="-23.28" width="50.13" height="98.19" transform="translate(23.28 74.91) rotate(-90)" fill="currentColor"/>\n      <rect class="cls-1" x="263.03" y="-23.28" width="50.13" height="98.19" transform="translate(262.28 313.91) rotate(-90)" fill="currentColor"/>\n      <circle class="cls-1" cx="126.65" cy="49.86" r="28.47" fill="currentColor" />\n      <circle class="cls-1" cx="164.59" cy="61.62" r="28.47" fill="currentColor" />\n      <circle class="cls-1" cx="204.24" cy="54.24" r="28.47" fill="currentColor" />\n      <circle class="cls-1" cx="232.71" cy="29.03" r="28.47" fill="currentColor" />\n      <circle class="cls-1" cx="104.6" cy="29.07" r="28.47" fill="currentColor" />\n      <path class="cls-1" d="M161.04,176.86L90.4,54.52l157.13-1.02-70.63,122.34c-3.53,6.11-12.34,6.11-15.86,1.02Z" fill="currentColor"/>\n</svg>\n';
const body3 = '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 309.52 181.82">\n      <rect class="cls-1" x="128.25" y="108.83" width="49.12" height="96.21" transform="translate(309.75 4.13) rotate(90)" fill="currentColor"/>\n      <path class="cls-1" d="M309.52.32c0,85.1-68.99,154.1-154.1,154.1S1.33,85.43,1.33.32h308.19Z" fill="currentColor"/>\n</svg>\n';
const foot0 = '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 149.62 95.45">\n      <path class="cls-1" d="M7.95,36.75C7.95,16.87,20.51.75,36,.75s28.05,16.12,28.05,36H7.95Z" fill="currentColor"/>\n      <path class="cls-1" d="M85.1,36.75c0-19.88,12.77-36,28.52-36s28.52,16.12,28.52,36h-57.03Z" fill="currentColor"/>\n      <path class="cls-1" d="M2.63,64.77c0-19.88,15.79-36,35.26-36s35.26,16.12,35.26,36H2.63Z" fill="currentColor"/>\n      <path class="cls-1" d="M79.95,64.77c0-19.88,15.26-36,34.09-36s34.09,16.12,34.09,36h-68.17Z" fill="currentColor"/>\n      <path class="cls-1" d="M0,94.7c0-19.88,16.12-36,36-36s36,16.12,36,36H0Z" fill="currentColor"/>\n      <path class="cls-1" d="M77.62,94.7c0-19.88,16.12-36,36-36s36,16.12,36,36h-72Z" fill="currentColor"/>\n</svg>\n';
const foot1 = '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 102.45 95.45">\n      <rect class="cls-1" x="26.67" width="49.12" height="95.45" transform="translate(102.45 95.45) rotate(180)" fill="currentColor"/>\n      <polygon class="cls-1" points="51.23 6.73 102.45 95.45 0 95.45 51.23 6.73" fill="currentColor"/>\n</svg>\n';
const foot2 = '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 62.17 95.45">\n      <path class="cls-1" d="M20.13,94.98L1.46.49s.01-.04.03-.04h37.34s.04.02.03.04l-18.67,94.49s-.06.04-.07,0Z" fill="currentColor"/>\n      <path class="cls-1" d="M41.98,94.98L23.31.49s.01-.04.03-.04h37.34s.04.02.03.04l-18.67,94.49s-.06.04-.07,0Z" fill="currentColor"/>\n</svg>\n';
const foot3 = '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 131.25 95.45">\n      <path class="cls-1" d="M0,94.7C0,42.82,29.38.75,65.62.75s65.62,42.06,65.62,93.95H0Z" fill="currentColor"/>\n</svg>\n';
const leg0 = '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 282.91 249.53">\n      <path class="cls-1" d="M1.14,90.26C1.14,40.28,63.94-.24,141.42-.24s140.29,40.52,140.29,90.5H1.14Z" fill="currentColor"/>\n      <polygon class="cls-1" points="182.47 249.76 274.56 90.26 8.29 90.26 100.38 249.76 182.47 249.76" fill="currentColor"/>\n</svg>\n';
const leg1 = '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 442.39 249.53">\n      <path class="cls-1" d="M.24,220.89C.24,98.89,99.13,0,221.13,0s220.89,98.89,220.89,220.89H.24Z" fill="currentColor"/>\n      <ellipse class="cls-1" cx="44.64" cy="220.89" rx="44.4" ry="28.64" fill="currentColor"/>\n      <ellipse class="cls-1" cx="133.44" cy="220.89" rx="44.4" ry="28.64" fill="currentColor"/>\n      <ellipse class="cls-1" cx="221.13" cy="220.89" rx="44.4" ry="28.64" fill="currentColor"/>\n      <ellipse class="cls-1" cx="309.93" cy="220.89" rx="44.4" ry="28.64" fill="currentColor"/>\n      <ellipse class="cls-1" cx="397.61" cy="220.89" rx="44.4" ry="28.64" fill="currentColor"/>\n</svg>\n';
const leg2 = '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 295.82 249.53">\n      <path class="cls-1" d="M195.2-.24h-98.17c-1.05,0-2.04.58-2.66,1.56l-45.96,72.63c-1.58,2.5-.03,6.02,2.66,6.02h190.1c2.69,0,4.24-3.52,2.66-6.02L197.85,1.32c-.62-.98-1.61-1.56-2.66-1.56Z" fill="currentColor"/>\n      <path class="cls-1" d="M207.55,80.55h-122.89c-1.31,0-2.55.58-3.33,1.56l-57.53,72.63c-1.98,2.5-.04,6.02,3.33,6.02h237.95c3.37,0,5.31-3.52,3.33-6.02l-57.53-72.63c-.77-.98-2.01-1.56-3.33-1.56Z" fill="currentColor"/>\n      <path class="cls-1" d="M221.15,160.76H74.6c-1.57,0-3.04.64-3.97,1.73L2.02,243.08c-2.37,2.78-.05,6.68,3.97,6.68h283.77c4.01,0,6.33-3.9,3.97-6.68l-68.61-80.6c-.92-1.09-2.4-1.73-3.97-1.73Z" fill="currentColor"/>\n</svg>\n';
const leg3 = '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 268.61 249.53">\n      <ellipse class="cls-1" cx="101.97" cy="43.88" rx="43.24" ry="27.89" transform="translate(19.2 117.86) rotate(-65.08)" fill="currentColor"/>\n      <ellipse class="cls-1" cx="167.88" cy="43.88" rx="27.89" ry="43.24" transform="translate(-2.86 74.84) rotate(-24.92)" fill="currentColor"/>\n      <ellipse class="cls-1" cx="227.31" cy="101.66" rx="27.89" ry="43.24" transform="translate(-21.67 105.26) rotate(-24.92)" fill="currentColor"/>\n      <ellipse class="cls-1" cx="167.54" cy="124.14" rx="27.89" ry="43.24" transform="translate(-36.71 82.17) rotate(-24.92)" fill="currentColor"/>\n      <ellipse class="cls-1" cx="235.97" cy="186.06" rx="27.89" ry="43.24" transform="translate(-56.43 116.77) rotate(-24.92)" fill="currentColor"/>\n      <ellipse class="cls-1" cx="167.73" cy="205.65" rx="27.89" ry="43.24" transform="translate(-71.04 89.84) rotate(-24.92)" fill="currentColor"/>\n      <ellipse class="cls-1" cx="101.77" cy="205.65" rx="43.24" ry="27.89" transform="translate(-127.61 211.27) rotate(-65.08)" fill="currentColor"/>\n      <ellipse class="cls-1" cx="41.23" cy="102.81" rx="43.24" ry="27.89" transform="translate(-69.39 96.87) rotate(-65.08)" fill="currentColor"/>\n      <ellipse class="cls-1" cx="101.77" cy="124.14" rx="43.24" ry="27.89" transform="translate(-53.7 164.11) rotate(-65.08)" fill="currentColor"/>\n      <ellipse class="cls-1" cx="32.57" cy="187.21" rx="43.24" ry="27.89" transform="translate(-150.93 137.86) rotate(-65.08)" fill="currentColor"/>\n</svg>\n';
const head0 = '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 101.62 127.69">\n      <ellipse class="cls-1" cx="22.09" cy="40.02" rx="20.31" ry="20.79" fill="currentColor"/>\n      <ellipse class="cls-1" cx="79.42" cy="40.02" rx="20.31" ry="20.79" fill="currentColor"/>\n      <polygon class="cls-1" points="50.33 0 78.48 49.91 22.19 49.91 50.33 0" fill="currentColor"/>\n      <path class="cls-1" d="M47.26,125.7L5.5,51.65c-1.49-2.65.37-5.96,3.36-5.96h83.51c2.99,0,4.86,3.31,3.36,5.96l-41.76,74.05c-1.49,2.65-5.23,2.65-6.72,0Z" fill="currentColor"/>\n</svg>\n';
const head1 = '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 140.73 127.69">\n      <circle class="cls-1" cx="70.45" cy="26.15" r="24.15" fill="currentColor"/>\n      <ellipse class="cls-1" cx="46.3" cy="75.31" rx="37.09" ry="57.49" transform="translate(-35.6 42.02) rotate(-36.3)" fill="currentColor"/>\n      <ellipse class="cls-1" cx="93.18" cy="75.48" rx="57.49" ry="37.09" transform="translate(-23.98 101.01) rotate(-51.3)" fill="currentColor"/>\n</svg>\n';
const head2 = '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 106.33 127.69">\n      <rect class="cls-1" x="41.64" y="-4.24" width="23.2" height="104.48" transform="translate(5.24 101.24) rotate(-90)" fill="currentColor"/>\n      <ellipse class="cls-1" cx="53.24" cy="38.04" rx="47.28" ry="36.82" fill="currentColor"/>\n      <path class="cls-1" d="M45.71,122.12L11.64,63.11c-3.35-5.8.84-13.04,7.53-13.04h68.14c6.69,0,10.87,7.24,7.53,13.04l-34.07,59.01c-3.35,5.8-11.71,5.8-15.06,0Z" fill="currentColor"/>\n</svg>\n';
const head3 = '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 144.22 127.69">\n      <circle class="cls-1" cx="116.99" cy="78.69" r="27.22" fill="currentColor"/>\n      <circle class="cls-1" cx="108.48" cy="42.23" r="27.22" fill="currentColor"/>\n      <circle class="cls-1" cx="70.99" cy="27.88" r="27.22" fill="currentColor"/>\n      <circle class="cls-1" cx="32.1" cy="44.29" r="27.22" fill="currentColor"/>\n      <circle class="cls-1" cx="27.22" cy="78.69" r="27.22" fill="currentColor"/>\n      <ellipse class="cls-1" cx="72.14" cy="84.83" rx="27.22" ry="42.2" fill="currentColor"/>\n</svg>\n';
const icons = {
    body0,
    body1,
    body2,
    body3,
    foot0,
    foot1,
    foot2,
    foot3,
    head0,
    head1,
    head2,
    head3,
    leg0,
    leg1,
    leg2,
    leg3
}

// UTILS
const getRandomIndex = (max) => Math.floor((Math.random()*max))


// COMMONS
const totemSections = [...document.querySelectorAll('.totem-section')]

let totemElements = []
function setTotemElements() {
    totemElements = totemSections.map(section => {
        const content = section.querySelector('.totem-section-content') || section.children[0]
        const controls = section.querySelector('.totem-section-controls') || section
        const shuffleButton = section.querySelector('.shuffle') || section

        return {
            section,
            content,
            controls,
            shuffleButton,
            type: section.getAttribute('data-totem-section')
        }
    })
}

function shuffleAllTotemElement() {
    totemElements.forEach((totem) => {
        insertRandomImg(totem)
    })
}

function closeAllControls() {
    totemElements.forEach(totem => {
        totem.controls.classList.remove('visible')
    })
}

function onTotemSectionClicked(event, totem) {
    if (event.target !== totem.section) return

    totem.controls.classList.toggle('visible')
}

function insertImg(totem, index = 0) {
    const svgFileName = `${totem.type}${index.toString()}`
    totem.content.innerHTML = icons[svgFileName]
}

function insertRandomImg(totem) {
    const length = Object.keys(icons).filter(key => key.includes(totem.type)).length

    insertImg(totem, getRandomIndex(length))
}



function initTotemItems() {
    setTotemElements()
    totemElements.forEach((totem) => {
        insertImg(totem, 0)
        totem.section.addEventListener('click', (e) => onTotemSectionClicked(e, totem), { capture: true });
        totem.shuffleButton.addEventListener('click', () => insertRandomImg(totem))
    })
}


function setGlobalMethods() {
    Object.assign(window, {
        appMethod: {
            closeAllControls: closeAllControls,
            shuffleAllTotemElement: shuffleAllTotemElement,
        }
    })
}

initTotemItems()
setGlobalMethods()
